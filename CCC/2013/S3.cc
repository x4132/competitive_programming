#include <bits/stdc++.h>
#define F first
#define S second
using namespace std;int w=0;int T,G;void s(vector<int>t,set<pair<int,int>>c){if(c.empty()){for(int i=0;i<4;i++)if(i!=T&&t[i]>=t[T])return;w++;return;}pair<int,int>m=*c.begin();c.erase(c.begin());t[m.F]+=3;s(t,c);t[m.F]-=3;t[m.S]+=3;s(t,c);t[m.S]-=2;t[m.F]++;s(t,c);}int main(void){set<pair<int,int>>c;for(int t1=0;t1<4;t1++){for(int t2=t1+1;t2<4;t2++){c.insert({t1,t2});}}cin>>T>>G;T--;vector<int>t(4,0);for(int i=0;i<G;i++){int a,b,bs,as;cin>>a>>b>>bs>>as;a--;b--;if(bs>as){t[a]+=3;}else if(as>bs){t[b]+=3;}else{t[a]++;t[b]++;}if(a>b){c.erase({b,a});}else{c.erase({a,b});}}s(t,c);cout<<w;}